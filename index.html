<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CreaTIC</title>
    <link rel="shortcut icon" href="./assets/favicon.png" type="image/x-icon" />
    <link rel="stylesheet" href="./styles/style.css" />
    <base target="_blank" />
  </head>
  <body>
    <div class="container">
      <header class="main-header">
        <h1>Panel de Gestión de Tareas</h1>
        <button id="logout-button">Cerrar Sesión</button>
      </header>

      <nav class="tabs">
        <button id="tab-creacion-masiva" class="tab-button supervisor-only">
          Creación Masiva
        </button>
        <button id="tab-crear-editar" class="tab-button supervisor-only">
          Crear / Editar
        </button>
        <button id="tab-gestionar" class="tab-button">Gestionar Tareas</button>
        <button id="tab-informes" class="tab-button supervisor-only">
          Informes
        </button>
        <button id="tab-ingreso-bbdd" class="tab-button admin-only">
          Ingreso a BBDD
        </button>
        <button id="tab-editar-bbdd" class="tab-button admin-only">
          Editar BBDD
        </button>
      </nav>

      <main>
        <div id="vista-creacion-masiva" class="tab-content">
          <form id="form-masivo">
            <div>
              <h2>Información General (Creación Masiva)</h2>
              <div class="grid-container">
                <div class="form-section">
                  <div>
                    <label for="select-cliente-masivo">Cliente</label>
                    <select id="select-cliente-masivo" required>
                      <option value="">Cargando...</option>
                    </select>
                  </div>
                  <div>
                    <label for="select-proyecto-masivo">Proyecto</label>
                    <select id="select-proyecto-masivo" disabled required>
                      <option value="">Seleccione...</option>
                    </select>
                  </div>
                </div>
                <div class="form-section">
                  <div>
                    <label for="select-unidad-negocio-masivo"
                      >Unidad de Negocio</label
                    >
                    <select id="select-unidad-negocio-masivo" required>
                      <option value="">
                        -- Seleccione para crear en lote --
                      </option>
                    </select>
                    <small
                      id="equipo-counter"
                      class="form-text-feedback"
                    ></small>
                  </div>
                  <div>
                    <label for="select-tecnico-masivo">Técnico</label>
                    <select id="select-tecnico-masivo" required>
                      <option value="">Seleccione...</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="submit-container">
              <button type="submit" id="btn-submit-masivo" disabled>
                Crear Tareas
              </button>
            </div>
          </form>
        </div>

        <div id="vista-crear-editar" class="tab-content">
          <form id="form-manual">
            <div>
              <h2 id="form-title-manual">
                Información General (Creación Manual)
              </h2>
              <div class="grid-container">
                <div class="form-section">
                  <div>
                    <label for="select-cliente-manual">Cliente</label>
                    <select id="select-cliente-manual" required>
                      <option value="">Cargando...</option>
                    </select>
                  </div>
                  <div>
                    <label for="select-proyecto-manual">Proyecto</label>
                    <select id="select-proyecto-manual" disabled required>
                      <option value="">Seleccione...</option>
                    </select>
                  </div>
                  <div>
                    <label for="select-tecnico-manual">Técnico</label>
                    <select id="select-tecnico-manual" required>
                      <option value="">Seleccione...</option>
                    </select>
                  </div>
                </div>
                <div class="form-section">
                  <div>
                    <label for="select-provincia">Provincia</label>
                    <select id="select-provincia" required>
                      <option value="">Cargando...</option>
                    </select>
                  </div>
                  <div>
                    <label for="select-ciudad">Ciudad</label>
                    <select id="select-ciudad" disabled required>
                      <option value="">Seleccione...</option>
                    </select>
                  </div>
                  <div>
                    <label for="select-agencia">Localidad / Agencia</label>
                    <select id="select-agencia" disabled required>
                      <option value="">Seleccione...</option>
                    </select>
                  </div>
                  <div>
                    <label>Unidad de Negocio</label>
                    <input
                      type="text"
                      id="info-unidad-negocio"
                      readonly
                      disabled
                    />
                  </div>
                </div>
              </div>
            </div>
            <div>
              <h2>Información de Equipo</h2>
              <div class="grid-container">
                <div>
                  <label for="select-equipo">Número de Serie del Equipo</label>
                  <select id="select-equipo" disabled required>
                    <option>Seleccione...</option>
                  </select>
                </div>
                <div class="form-section">
                  <div>
                    <label>Nombre del Equipo</label>
                    <input type="text" id="info-nombre-equipo" readonly />
                  </div>
                  <div>
                    <label>Modelo y Características</label>
                    <textarea
                      id="info-caracteristicas-equipo"
                      rows="3"
                      readonly
                    ></textarea>
                  </div>
                </div>
              </div>
            </div>
            <div class="submit-container">
              <button
                type="button"
                id="btn-cancelar-manual"
                class="button-secondary"
                style="display: none"
              >
                Cancelar
              </button>
              <button type="submit" id="btn-submit-manual" disabled>
                Crear Tarea
              </button>
            </div>
          </form>
        </div>

        <div id="vista-gestionar" class="tab-content active">
          <div class="gestion-header">
            <div>
              <h2>Tareas Creadas</h2>
              <p>Aquí puedes ver, editar o eliminar las tareas asignadas.</p>
            </div>
            <button
              id="btn-delete-selected"
              class="button-secondary"
              style="display: none"
            >
              Eliminar Seleccionados (0)
            </button>
          </div>
          <div id="lista-tareas-container" class="task-list">
            <p>Cargando tareas...</p>
          </div>
        </div>

        <div id="vista-informes" class="tab-content">
          <div class="gestion-header">
            <h2>Generación de Informes</h2>
            <p>
              Seleccione una tarea completada para generar la ficha de
              mantenimiento.
            </p>
          </div>
          <div id="lista-informes-container" class="task-list">
            <p>Cargando tarea de ejemplo...</p>
          </div>

          <div id="ficha-container" class="hidden">
            <div class="ficha-actions">
              <button id="btn-volver-lista" class="button-secondary">
                ← Volver a la lista
              </button>
              <button id="btn-exportar-pdf">Exportar Ficha Actual</button>
            </div>
            <div id="ficha-mantenimiento" class="ficha-mantenimiento"></div>
          </div>
        </div>

        <div id="vista-ingreso-bbdd" class="tab-content">
          <div class="gestion-header">
            <h2>Ingreso a Base de Datos</h2>
            <p>
              Formularios para crear nuevos Clientes, Proyectos, Equipos, etc.
            </p>
          </div>
        </div>

        <div id="vista-editar-bbdd" class="tab-content">
          <div class="gestion-header">
            <h2>Edición de Base de Datos</h2>
            <p>Grilla para editar o eliminar registros existentes.</p>
          </div>
        </div>
      </main>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script src="js/api-service.js" type="module"></script>
    <script src="js/auth-guard.js" type="module"></script>
    <script src="js/app.js" type="module"></script>
  </body>
</html>
